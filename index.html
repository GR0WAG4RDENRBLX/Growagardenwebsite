
import React, { useState } from "react";
import { DndContext, useDraggable, useDroppable } from "@dnd-kit/core";

const themes = [
  { name: "Minimal", className: "bg-white text-black" },
  { name: "Dark", className: "bg-gray-900 text-white" },
  { name: "Peach", className: "bg-orange-100 text-orange-900" }
];

function ReviewBlock({ data, onChange }) {
  return (
    <div className="p-4 border rounded bg-white shadow">
      <input
        type="text"
        placeholder="Name"
        value={data.name}
        onChange={(e) => onChange({ ...data, name: e.target.value })}
        className="block w-full mb-2 p-2 border rounded"
      />
      <textarea
        placeholder="Review text"
        value={data.text}
        onChange={(e) => onChange({ ...data, text: e.target.value })}
        className="block w-full p-2 border rounded"
      />
    </div>
  );
}

const blocks = {
  review: ({ data, onChange }) => <ReviewBlock data={data} onChange={onChange} />,
  button: () => (
    <button className="m-4 px-4 py-2 bg-blue-500 text-white rounded">
      Click Me
    </button>
  ),
  image: () => (
    <img
      src="https://placekitten.com/400/200"
      alt="Placeholder"
      className="m-4 rounded"
    />
  ),
  link: () => (
    <a href="#" className="m-4 text-blue-600 underline">
      Example Link
    </a>
  )
};

function Block({ id, type, data, onChange }) {
  const { attributes, listeners, setNodeRef, transform } = useDraggable({ id });
  const style = transform
    ? { transform: `translate(${transform.x}px, ${transform.y}px)` }
    : undefined;

  const blockRender = blocks[type];
  return (
    <div ref={setNodeRef} style={style} {...listeners} {...attributes} className="cursor-move mb-4">
      {blockRender({ data, onChange })}
    </div>
  );
}

function Canvas({ blocksList, updateBlock }) {
  const { setNodeRef } = useDroppable({ id: "canvas" });
  return (
    <div ref={setNodeRef} className="min-h-[500px] p-6 border rounded-lg bg-white shadow-inner">
      {blocksList.map((block, idx) => (
